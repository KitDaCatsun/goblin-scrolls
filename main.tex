% !TeX root = main.tex

% TODO:
% - Replace `example' with `examples'
% - Use subsubsections

\documentclass[twoside]{report}

\usepackage[a4paper, margin=1in]{geometry}
\usepackage[utf8]{inputenc}
\usepackage{hyperref}
\usepackage{xcolor, textgreek, amssymb, amsmath, amsthm, tikz, graphicx, multirow, booktabs, bbold, listings, fancyhdr, titlecaps, cleveref, appendix}

\usetikzlibrary{automata, positioning, arrows, arrows.meta, calc, decorations.markings, circuits.logic.US}

\hypersetup{
    pdfauthor={Kit Matthewson},
    pdftitle={The Goblin Scrolls},
    pdfpagemode=FullScreen,
    colorlinks=true,
    linkcolor=black,
    filecolor=gray,
    urlcolor=teal,
    citecolor=black,
    breaklinks=false,
}

\newcounter{module}
\makeatletter
\@addtoreset{chapter}{part}
\makeatother
\newcommand{\module}[3]{%
    \setcounter{chapter}{0}%
    \setcounter{module}{#1}%
    \renewcommand{\partname}{Module}%
    \renewcommand{\thepart}{ECM\arabic{module}}%
    \part[#2]{#2\\\vspace{1\baselineskip}\small\emph{#3}}%
    \renewcommand{\partname}{Part}%
    \renewcommand{\thepart}{\Roman{part}}%
}

\newcommand{\tocchapter}[1]{%
  \stepcounter{chapter}%
  \addcontentsline{toc}{chapter}{\protect\numberline{\thechapter}#1}%
}

\newcommand{\tocsection}[1]{%
  \stepcounter{section}%
  \addcontentsline{toc}{section}{\protect\numberline{\thesection}#1}%
}

\renewcommand{\arraystretch}{1.2}

\renewcommand{\chaptermark}[1]{\markboth{#1}{}}

\definecolor{gruvbox-black}{HTML}{282828}
\definecolor{gruvbox-white}{HTML}{ebdbb2}
\definecolor{gruvbox-yellow}{HTML}{b57614}
\definecolor{gruvbox-purple}{HTML}{8f3f71}
\definecolor{gruvbox-blue}{HTML}{076678}
\definecolor{gruvbox-green}{HTML}{98971a}
\definecolor{gruvbox-red}{HTML}{cc241d}

\lstset{
    basicstyle=\color{gruvbox-black}\ttfamily,
    keywordstyle=\color{gruvbox-red},
    commentstyle=\color{gruvbox-blue},
    stringstyle=\color{gruvbox-green},
    numberstyle=\tiny\color{gruvbox-black},
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    columns=fullflexible,
    breaklines=true,
    postbreak=\mbox{\textcolor{gray}{\(\hookrightarrow\)}\space},
    escapechar=\$
}

\theoremstyle{definition}
\newtheorem{example}{Example}[section]
\newtheorem{examples}{Examples}[section]
\newtheorem{theorem}{Theorem}[section]

\newcommand*\parttitle{}
\let\origpart\part
\renewcommand*{\part}[2][]{%
    \ifx\\#1\\%
    \origpart{#2}%
        \renewcommand*\parttitle{#2}%
    \else
    \origpart[#1]{#2}%
        \renewcommand*\parttitle{#1}%
    \fi
}

\begin{document}

\include{preamble.tex}

\begin{titlepage}

    \centering
    \vspace*{\baselineskip}

    \rule{\textwidth}{1.6pt}\vspace*{-\baselineskip}\vspace*{2pt}
    \rule{\textwidth}{0.4pt}

    \vspace{0.75\baselineskip}

    {\scshape\LARGE THE GOBLIN SCROLLS}

    \rule{\textwidth}{0.4pt}\vspace*{-\baselineskip}\vspace{3.2pt}
    \rule{\textwidth}{1.6pt}

    \vspace{2\baselineskip}

    Notes on the University of Exeter Computer Science course.

    \vspace*{5\baselineskip}

    Composed by the Sage of the Codes

    \vspace{0.5\baselineskip}

    {\scshape\Large Kit Matthewson}

    \vspace{1\baselineskip}

    As unveiled to Him by

    \vspace{0.5\baselineskip}

    {\scshape\Large Jah}

    \vspace{5\baselineskip}

    {\scshape\normalsize United against Babylon}

    \vspace{5\baselineskip}

    Dedicated to

        {\scshape\normalsize His Imperial Majesty King Haile Selassie I\\Defender of the Faith,\\Reincarnation of the Son.}

    \vspace{12\baselineskip}

    As Declared on \today

\end{titlepage}

\tableofcontents

\clearpage

\pagestyle{fancy}
\fancyhead{}
\fancyhead[RE, LO]{The Goblin Scrolls}
\fancyhead[LE, RO]{\parttitle: \leftmark}
\fancyfoot{}
\fancyfoot[C]{\thepage}

\input{ECM1011/part.tex}
\input{ECM1400/part.tex}
\input{ECM1407/part.tex}
\input{ECM1415/part.tex}

\begin{appendices}
    \part{Appendices}
    \input{appendices/assessments/part.tex}
    \input{appendices/workshops/ECM1011/part.tex}
    \input{appendices/workshops/ECM1400/part.tex}
    \input{appendices/workshops/ECM1407/part.tex}
    \input{appendices/workshops/ECM1415/part.tex}
\end{appendices}

\end{document}
